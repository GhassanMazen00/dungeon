<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Unlock Ghassan‚Äôs Vault</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
    :root { --accent:#00ffea; --accent2:#ff0080; }
    html,body{height:100%}
    body {
      margin:0; padding-top:50px;
      min-height:100vh; display:flex; align-items:flex-start; justify-content:center;
      font-family:'Press Start 2P',cursive; color:#fff; text-align:center;
      background: linear-gradient(135deg, #ff0080, #7928ca, #2afadf, #ff8c00);
      background-size:400% 400%; animation: gradientShift 8s ease infinite;
    }
    @keyframes gradientShift {0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}

    /* Top banners */
    .top-title {
      position:fixed; top:0; width:100%; background:rgba(0,0,0,0.7); color:var(--accent);
      padding:10px; font-size:12px; border-bottom:2px solid #ff0; text-shadow:2px 2px #000; z-index:1000;
    }
    #adminBanner {
      display:none; position:fixed; top:44px; left:50%; transform:translateX(-50%);
      background:#ff1744; color:#fff; padding:8px 12px; border-radius:6px; z-index:1000; font-size:12px;
      box-shadow:0 4px 12px rgba(0,0,0,0.6);
    }

    /* Card */
    .card {
      width:940px; max-width:94%; margin:28px auto; background:linear-gradient(180deg, rgba(0,0,0,0.45), rgba(0,0,0,0.65));
      border:3px solid var(--accent); border-radius:14px; padding:26px; box-shadow:10px 10px 0 rgba(0,0,0,0.6);
    }
    h1{font-size:20px;margin:6px 0 16px;text-shadow:3px 3px #000}

    /* character */
    .character-container { position:relative; display:flex; justify-content:center; margin-bottom:12px; }
    canvas#pixelChar { width:128px; height:128px; image-rendering:pixelated; background:#111; border:3px solid #000; border-radius:8px; cursor:pointer; box-shadow:6px 6px 0 rgba(0,0,0,0.6); transition:transform .08s ease; }
    .chat-bubble { position:absolute; bottom:140px; left:50%; transform:translateX(-50%); display:none; background:#fff; color:#000; padding:8px 10px; border-radius:10px; font-family:'Press Start 2P',cursive; font-size:12px; border:4px solid var(--accent); max-width:260px; z-index:80; }
    .chat-bubble::after { content:""; position:absolute; left:50%; transform:translateX(-50%); bottom:-12px; border-width:8px 8px 0 8px; border-style:solid; border-color:var(--accent) transparent transparent transparent; }

    /* controls */
    .controls { display:flex; gap:10px; align-items:center; justify-content:center; flex-wrap:wrap; margin-bottom:8px; }
    input[type="password"] { padding:12px; width:220px; background:#111; color:#0f0; border:3px solid #000; text-align:center; font-family:'Press Start 2P',cursive; outline:none; }
    button.btn { padding:12px 14px; width:220px; background:var(--accent2); color:#fff; border:3px solid #000; cursor:pointer; font-family:'Press Start 2P',cursive; transition:.15s; }
    button.btn:hover{ background:var(--accent); color:#000; }

    /* links */
    .links { display:flex; flex-direction:column; align-items:center; gap:12px; margin-top:16px; }
    .links button, .links a { width:220px; text-align:center; text-decoration:none; color:var(--accent); font-size:14px; text-shadow:2px 2px #000; background:transparent; border:none; cursor:pointer; }

    .badge { display:inline-block; margin-left:10px; padding:6px 8px; background:var(--accent); color:#000; border:3px solid #000; box-shadow:3px 3px #000; font-size:10px; vertical-align:middle; }

    /* notes */
    #notesSection { margin-top:20px; padding:18px; background:rgba(0,0,0,0.6); border:3px solid var(--accent); border-radius:12px; max-width:900px; margin-left:auto; margin-right:auto; }
    #notesSection h2 { color:#ff0; font-size:14px; margin-bottom:12px; text-shadow:1px 1px #000; }
    .note-form { display:flex; flex-direction:column; align-items:center; gap:8px; margin-bottom:14px; }
    .note-form input, .note-form textarea { width:100%; max-width:520px; background:#111; color:#0f0; border:2px solid var(--accent); padding:10px; font-size:12px; }
    .notes-wall { display:grid; grid-template-columns: repeat(auto-fill,minmax(220px,1fr)); gap:12px; }
    .note { background:#222; border:3px solid var(--accent2); padding:12px; box-shadow:3px 3px #000; font-size:12px; text-align:left; min-height:76px; position:relative; transform:rotate(-1deg); }
    .note:nth-child(odd){ background:#333;border-color:var(--accent); transform:rotate(1deg) }
    .note .nickname{ color:#ff0; display:block; margin-bottom:6px; font-weight:bold; }
    .delete-btn{ display:inline-block;margin-top:8px;background:#e60026;border:3px solid #000;color:#fff;padding:6px 8px;font-size:10px;cursor:pointer;box-shadow:2px 2px #000 }

    /* modal */
    .modal { display:none; position:fixed; left:0; top:0; width:100%; height:100%; background:rgba(0,0,0,0.9); justify-content:center; align-items:center; z-index:900; }
    .modal .modal-content { background:#111; padding:20px; border:4px solid var(--accent); border-radius:10px; display:flex; gap:14px; flex-wrap:wrap; justify-content:center; max-width:900px; }

    /* shake */
    .shake { animation: shakeAnim .5s; }
    @keyframes shakeAnim { 0%{transform:translateX(0)}25%{transform:translateX(-6px)}50%{transform:translateX(6px)}75%{transform:translateX(-4px)}100%{transform:translateX(0)} }

    @media (max-width:640px){ canvas#pixelChar{width:96px;height:96px} .chat-bubble{bottom:110px;font-size:11px} button.btn,input[type="password"]{width:180px} .card{padding:14px} }
  </style>
</head>
<body>
  <div class="top-title">Abo Mazen's dungeon</div>
  <div id="adminBanner">ADMIN MODE ACTIVE</div>

  <div class="card">
    <!-- Character -->
    <div class="character-container">
      <canvas id="pixelChar" width="128" height="128" title="Ghassan's Pixel"></canvas>
      <div id="chatBubble" class="chat-bubble"></div>
    </div>

    <h1>üïπÔ∏è ENTER THE KEY</h1>

    <div class="controls">
      <input id="keyInput" type="password" placeholder="Type here..." onkeydown="if(event.key==='Enter') unlock()">
      <button class="btn" onclick="showHint()">üí° Hint</button>
    </div>

    <div style="margin-top:6px">
      <button class="btn" onclick="unlock()">UNLOCK</button>
    </div>

    <div id="links" class="hidden">
      <h2> üéâ ACCESS GRANTED <span id="roleBadge" class="badge" style="display:none">ADMIN MODE</span> </h2>
      <div class="links">
        <button onclick="window.open('https://github.com/GhassanMazen00/GhassanMazen00','_blank')">üíª GitHub</button>
        <button onclick="window.open('https://t.snapchat.com/p3KLzoLR','_blank')">üëª Snapchat</button>
        <button onclick="window.open('mailto:ghassanmazen@zohomail.com','_blank')">üìß Email</button>
        <button onclick="openModal()">üíÉ My Bitches</button>
        <button onclick="trap()">üîû +18 Pics of Ghassan</button>
      </div>

      <div id="notesSection">
        <h2>üìù Visitor Wall</h2>
        <div class="note-form">
          <input type="text" id="nickname" placeholder="Your nickname...">
          <textarea id="noteText" rows="3" placeholder="Leave a note..."></textarea>
          <button class="btn" onclick="addNote()">Post Note</button>
        </div>
        <div class="notes-wall" id="notesWall"></div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div id="myModal" class="modal" onclick="closeModal(event)">
    <div class="modal-content" onclick="event.stopPropagation()">
      <a href="https://www.instagram.com/loai_abb/" target="_blank"><img src="https://i.postimg.cc/XqLnjRMS/20250819-2117-Pixel-Ginger-Character-simple-compose-01k31rss70fmktq7sny215zh9h.png" width="80" class="pixel-character"></a>
      <a href="https://www.instagram.com/osaidjano/" target="_blank"><img src="https://i.postimg.cc/JhH7NYXZ/20250819-2129-Pixel-Man-with-T-Shirt-simple-compose-01k31scc2efvfbt02vce5hkp5r.png" width="80" class="pixel-character"></a>
      <a href="https://www.instagram.com/loai_kashkash/" target="_blank"><img src="https://i.postimg.cc/76gxcCmL/20250819-2136-Pixel-Fat-Man-simple-compose-01k31sw-dygemgba9w7vm7tmpq5.png" width="80" class="pixel-character"></a>
      <a href="https://www.instagram.com/khalid.alfares1/" target="_blank"><img src="https://i.postimg.cc/d1Ms4RRX/20250819-2140-Pixel-Man-with-Flag-simple-compose-01k31t39ykee6bbh3fcc1xfhjv-removebg-preview.png" width="80" class="pixel-character"></a>
      <a href="https://www.instagram.com/badr_sanoufi/" target="_blank"><img src="https://i.postimg.cc/j2tsrsF4/assets-task-01k31taeamf6tavtp3htwn6b2h-1755629076-img-0.webp" width="80" class="pixel-character"></a>
      <button class="btn" style="width:auto;" onclick="closeModal(event)">CLOSE</button>
    </div>
  </div>

  <!-- Firebase libs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

  <script>
  // -------------------------
  // Config & state
  // -------------------------
  const VISITOR_PASS = "10101999";
  const ADMIN_PASS = "ananke";
  let mode = 'locked';
  let isAdmin = false;

  const firebaseConfig = { databaseURL: "https://dungeon-data-base-default-rtdb.firebaseio.com/" };
  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // -------------------------
  // Pixel character (programmatic) - idle blink, hover wave, wrong shake, 5-click hater
  // -------------------------
  const canvas = document.getElementById('pixelChar');
  const ctx = canvas.getContext('2d', { alpha: true });
  const chatBubble = document.getElementById('chatBubble');

  // Character colors
  const COLORS = {
    skin: '#D3A57A', hair:'#2E1E0F', beard:'#2E1E0F', tshirt:'#222', tshAcc:'#fff', haterTint:'#8b0000'
  };

  let blinkTimer = 0, inWave = false, haterMode = false, clickCount = 0, lastClick = 0, shaking = false;

  function shade(hex, percent){
    const f = hex.slice(1), t = percent<0 ? 0:255, p=Math.abs(percent);
    const R=parseInt(f.substring(0,2),16), G=parseInt(f.substring(2,4),16), B=parseInt(f.substring(4,6),16);
    const newR = Math.round((t-R)*p)+R, newG = Math.round((t-G)*p)+G, newB = Math.round((t-B)*p)+B;
    return '#'+((1<<24)+(newR<<16)+(newG<<8)+newB).toString(16).slice(1);
  }

  function drawCharacter({blink=false, wave=false, hater=false} = {}){
    const grid = 32; const px = canvas.width / grid;
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.save();
    if (shaking) {
      const dx = (Math.random()*6 - 3);
      ctx.translate(dx, 0);
    }
    function p(x,y,color){ ctx.fillStyle = color; ctx.fillRect(Math.round(x*px), Math.round(y*px), Math.ceil(px), Math.ceil(px)); }

    const skin = hater ? shade(COLORS.skin, -0.15) : COLORS.skin;
    const hair = hater ? shade(COLORS.hair, 0.15) : COLORS.hair;
    const beard = hater ? shade(COLORS.beard, 0.15) : COLORS.beard;
    const tsh = hater ? shade(COLORS.tshirt, -0.25) : COLORS.tshirt;
    const tshAcc = hater ? COLORS.haterTint : COLORS.tshAcc;

    // head area
    const hx=12, hy=4;
    // hair row
    for(let sx=0;sx<8;sx++){ p(hx-1+sx, hy-1, hair); if (sx===0||sx===7) p(hx-1+sx, hy, hair); }
    // skin rectangle 8x6
    for(let yy=0; yy<6; yy++) for(let xx=0; xx<8; xx++) p(hx-1+xx, hy+yy, skin);
    // beard (short) row
    for(let xx=0;xx<8;xx++) p(hx-1+xx, hy+6, beard);
    // eyes
    if (blink) { p(hx+1, hy+2, '#111'); p(hx+4, hy+2, '#111'); }
    else { p(hx+1, hy+2, '#000'); p(hx+4, hy+2, '#000'); p(hx+1, hy+3, '#fff'); p(hx+4, hy+3, '#fff'); }

    // body 10x8 starting hy+8
    for(let yy=0;yy<8;yy++) for(let xx=0;xx<10;xx++) p(hx-2+xx, hy+8+yy, tsh);

    // Deathly Hallows symbol (simple)
    const triX = hx+2, triY = hy+10;
    p(triX, triY, tshAcc);
    p(triX-1, triY+1, tshAcc); p(triX, triY+1, tshAcc); p(triX+1, triY+1, tshAcc);
    p(triX-2, triY+2, tshAcc); p(triX-1, triY+2, tshAcc); p(triX, triY+2, tshAcc); p(triX+1, triY+2, tshAcc); p(triX+2, triY+2, tshAcc);
    // inner tiny hole
    p(triX, triY+1, '#000');
    // vertical line
    for(let l=0;l<5;l++) p(triX, triY+l, tshAcc);

    // left arm (down)
    for(let a=0;a<4;a++) p(hx-4+a, hy+10+a, tsh);
    // right arm (wave or down)
    if (wave) { p(hx+9, hy+6, tsh); p(hx+10, hy+6, tsh); p(hx+9, hy+7, tsh); p(hx+8, hy+8, tsh); }
    else { p(hx+10, hy+12, tsh); p(hx+10, hy+13, tsh); p(hx+9, hy+14, tsh); }

    // small hater brow
    if (hater) { p(hx+1, hy+1, '#111'); p(hx+4, hy+1, '#111'); }

    ctx.restore();
  }

  // animation loop
  function animLoop(){
    blinkTimer++;
    const blink = (blinkTimer % 80 === 0) || (blinkTimer % 200 === 0 && Math.random()>0.6);
    drawCharacter({ blink: blink, wave: inWave, hater: haterMode });
    // wave auto-off after a moment
    if (inWave) setTimeout(()=>inWave=false, 800);
    requestAnimationFrame(animLoop);
  }
  requestAnimationFrame(animLoop);

  // bubble show
  let bubbleTimeout = null;
  function showBubble(text, ms=2000){
    if (bubbleTimeout) clearTimeout(bubbleTimeout);
    chatBubble.textContent = text; chatBubble.style.display='block';
    bubbleTimeout = setTimeout(()=>{ chatBubble.style.display='none'; bubbleTimeout=null }, ms);
  }

  // interactions
  canvas.addEventListener('mouseover', ()=>{ inWave = true; showBubble("Hey, don't hover too close üëÄ"); });
  canvas.addEventListener('click', ()=>{
    const now = Date.now();
    if (now - lastClick < 800) clickCount++; else clickCount = 1;
    lastClick = now;
    if (clickCount >= 5){
      clickCount = 0; haterMode = true; showBubble("I'm the hater boss now üòà", 3500);
      setTimeout(()=>{ haterMode = false; }, 5500);
    } else {
      const msgs = ["Yo.","Sup.","Try the key.","Nice shirt."]; showBubble(msgs[Math.floor(Math.random()*msgs.length)],1200);
    }
  });

  function triggerShake(){
    shaking = true; canvas.classList.add('shake');
    setTimeout(()=>{ shaking=false; canvas.classList.remove('shake'); }, 520);
  }

  // -----------------------
  // Password / UI logic
  // -----------------------
  function unlock(){
    const key = document.getElementById('keyInput').value.trim();
    checkPassword(key);
  }

  function checkPassword(key){
    const links = document.getElementById('links');
    const roleBadge = document.getElementById('roleBadge');
    const adminBanner = document.getElementById('adminBanner');

    if (key === VISITOR_PASS){
      mode='visitor'; isAdmin=false;
      links.classList.remove('hidden');
      roleBadge.style.display='none';
      adminBanner.style.display='none';
      displayNotes();
      showBubble("Alright, get in.");
    } else if (key === ADMIN_PASS){
      mode='admin'; isAdmin=true;
      links.classList.remove('hidden');
      roleBadge.style.display='inline-block';
      adminBanner.style.display='block';
      displayNotes();
      showBubble("Respect, boss üòè");
    } else {
      showBubble("Bruh‚Ä¶ wrong again.");
      triggerShake();
    }
  }

  function showHint(){ showBubble("When was the greatest human on earth born? (type numbers only: ddmmyyyy)", 3200); }
  function trap(){ showBubble("‚ö†Ô∏è Ghassan got notified that you tried to see him naked, shame on you!", 3000); }
  function openModal(){ document.getElementById('myModal').style.display='flex'; }
  function closeModal(e){ if (e) e.stopPropagation(); document.getElementById('myModal').style.display='none'; }

  // -----------------------
  // Firebase notes
  // -----------------------
  function escapeHTML(str){ return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

  function addNote(){
    const nickname = document.getElementById('nickname').value.trim();
    const noteText = document.getElementById('noteText').value.trim();
    if (!nickname || !noteText){ showBubble("Enter name & note", 1800); return; }
    db.ref("notes").push({ nickname, noteText });
    document.getElementById('nickname').value=''; document.getElementById('noteText').value='';
  }

  function displayNotes(){
    const notesWall = document.getElementById('notesWall');
    notesWall.innerHTML = "";
    db.ref("notes").on("value", snapshot=>{
      notesWall.innerHTML = "";
      snapshot.forEach(child=>{
        const n = child.val();
        const noteDiv = document.createElement('div');
        noteDiv.className = 'note';
        const safeNick = escapeHTML(n.nickname);
        const safeText = escapeHTML(n.noteText).replace(/\n/g,'<br>');
        noteDiv.innerHTML = `<span class="nickname">${safeNick}</span><div>${safeText}</div>`;
        if (isAdmin){
          const del = document.createElement('button');
          del.className = 'delete-btn';
          del.textContent = '‚ùå Delete';
          del.onclick = ()=>{ db.ref("notes/" + child.key).remove(); };
          noteDiv.appendChild(del);
        }
        notesWall.appendChild(noteDiv);
      });
    });
  }

  // -----------------------
  // init: keep displayNotes subscription only active after unlock
  // but keep safety if someone reloads and isAdmin false
  // -----------------------
  // (No automatic display of links until unlock)

  </script>
</body>
</html>
